// Generated by CoffeeScript 1.3.3
(function() {

  define(['./socket', 'jquery'], function(socket, $) {
    return {
      start: function() {
        var getTouchPosition, height, lastTouch, onTouchEnd, onTouchMove, width;
        socket.emit('player:register', '');
        height = $('body').height();
        width = $('body').height();
        lastTouch = null;
        getTouchPosition = function(e) {
          var move, touch;
          touch = e.originalEvent.touches[0];
          if (!lastTouch) {
            lastTouch = touch;
            return false;
          } else {
            move = [(touch.clientX - lastTouch.clientX) / width, (touch.clientY - lastTouch.clientY) / height];
            lastTouch = touch;
            return move;
          }
        };
        onTouchMove = function(e) {
          var move;
          move = getTouchPosition(e);
          if (move) {
            return socket.emit('move', move);
          }
        };
        onTouchEnd = function() {
          return lastTouch = null;
        };
        $('body div').on('touchmove', onTouchMove);
        return $('body div').on('touchend', onTouchEnd);
      }
    };
  });

}).call(this);
